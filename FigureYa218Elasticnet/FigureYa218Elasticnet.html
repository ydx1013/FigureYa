<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'><style type='text/css'>html {overflow-x: initial !important;}</style>
<style type='text/css'  id="style-base">:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, "Segoe UI Emoji", "SF Pro", sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.428571; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p *, #write.first-line-indent svg * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-width: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-variant-alternates: inherit; font-variant-ligatures: inherit; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-variant-position: inherit; font-variant-emoji: inherit; font-feature-settings: inherit; font-optical-sizing: inherit; font-variation-settings: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; position: relative; }
#write svg h1, #write svg h2, #write svg h3, #write svg h4, #write svg h5, #write svg h6, #write svg p { position: static; white-space: nowrap; overflow: visible; }
foreignObject { overflow: visible; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; border-right-style: none; border-right-color: currentcolor; background-color: inherit; }
.CodeMirror-linenumber { -webkit-user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: medium; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: medium !important; border-style: none !important; border-color: currentcolor !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; border-bottom-style: none; border-bottom-color: currentcolor; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: medium; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.mermaid-svg { margin: auto; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left-width: 0.25em; border-left-style: solid; border-left-color: rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }

</style>
<style type='text/css'  id="style-codemirror">.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: medium !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}

</style>
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&amp;subset=latin,latin-ext' type='text/css' />
<style type='text/css'  id="style-theme_css">:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', 'SF Pro', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.mac-os #write{
    caret-color: AccentColor;
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}
</style>
<style type='text/css'  id="style-lp">ol, ul {padding-left: 40px}</style>
<style type='text/css'  id="style-mac-print"> @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}</style>

<title>FigureYa218Elasticnet_副本.Rmd</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='figureya218elasticnet'><span>FigureYa218Elasticnet</span></h1><h5 id='xiaofan-lu-ying-ge-yijing-chen'><span>Xiaofan Lu; Ying Ge, Yijing Chen</span></h5><h5 id='2025-5-20'><span>2025-5-20</span></h5><h1 id='需求描述'><span>需求描述</span></h1><h1 id='requirement-description'><span>requirement description</span></h1><p><span>我想众筹弹性网络筛选和分类的数据分析。根据表达矩阵，绘制figure2的A,B,C筛选和系数图，再根据结果绘制分类效果E图，得到准确率。</span></p><p><span>I would like to crowdfund data analysis for resilient network screening and classification. Based on the expression matrix, I will generate the screening and coefficient plots for groups A, B, and C as shown in Figure 2. Subsequently, I will plot the classification performance diagram E based on the results to determine the accuracy rate.</span></p><p><img src="example.png"></p><p><span>出自</span><a href='https://www.frontiersin.org/articles/10.3389/fgene.2020.00857/full' target='_blank' class='url'>https://www.frontiersin.org/articles/10.3389/fgene.2020.00857/full</a></p><p><span>FIGURE 2 | The screening and validation of 15 genes conducted by the diagnostic classifier. </span>
<span>(A,B) Binomial deviance as a function of the regularization parameter lambda for leave-one-study-out cross-validation on the training datasets. Points correspond to the means, and error bars correspond to the standard deviations. Coefficients of 15 genes were selected by the lambda with the minimum binomial deviance marked by the blue dashed line (lambda = 0.025, ln(lambda) = −3.692). </span>
<span>(C) Coefficient values for each of the fifteen selected genes. A positive coefficient for a gene signature within its class indicates that elevated expression of this gene increases the probability of a specimen belonging to its tissue type. </span>
<span>(D) Heatmap for describing the expression levels of selected genes in the binomial classifier erected by training datasets. Each row is a gene with its Entrez Gene ID in parentheses; each column is a sample. </span>
<span>(E) Estimated probabilities for samples in testing datasets (GSE101685 and ICGC). For each sample, there are two points, corresponding to the probability that the sample belongs to the respective class. Within each dataset and class, samples are sorted by the probability of the true class. For most samples, the probability of the true subtype is near 1, indicating an unambiguous classification.</span></p><p><span>from</span><a href='https://www.frontiersin.org/articles/10.3389/fgene.2020.00857/full' target='_blank' class='url'>https://www.frontiersin.org/articles/10.3389/fgene.2020.00857/full</a></p><p><span>FIGURE 2 | The screening and validation of 15 genes conducted by the diagnostic classifier. </span>
<span>(A,B) Binomial deviance as a function of the regularization parameter lambda for leave-one-study-out cross-validation on the training datasets. Points correspond to the means, and error bars correspond to the standard deviations. Coefficients of 15 genes were selected by the lambda with the minimum binomial deviance marked by the blue dashed line (lambda = 0.025, ln(lambda) = −3.692). </span>
<span>(C) Coefficient values for each of the fifteen selected genes. A positive coefficient for a gene signature within its class indicates that elevated expression of this gene increases the probability of a specimen belonging to its tissue type. </span>
<span>(D) Heatmap for describing the expression levels of selected genes in the binomial classifier erected by training datasets. Each row is a gene with its Entrez Gene ID in parentheses; each column is a sample. </span>
<span>(E) Estimated probabilities for samples in testing datasets (GSE101685 and ICGC). For each sample, there are two points, corresponding to the probability that the sample belongs to the respective class. Within each dataset and class, samples are sorted by the probability of the true class. For most samples, the probability of the true subtype is near 1, indicating an unambiguous classification.</span></p><h1 id='应用场景'><span>应用场景</span></h1><h1 id='application-scenario'><span>application scenario</span></h1><p><span>根据弹性网络筛选变量构建分类模型，生成筛选和系数图，以及分类效果图。</span></p><p><span>更多机器学习相关FigureYa看这里</span><a href='https://k.koudai.com/ZkmRxldV' target='_blank' class='url'>https://k.koudai.com/ZkmRxldV</a></p><p><span>Construct a classification model by selecting variables based on the elastic net, generate screening and coefficient diagrams, as well as classification effect diagrams.</span></p><p><span>For more machine learning-related FigureYa, please refer to this link </span><a href='https://k.koudai.com/ZkmRxldV' target='_blank' class='url'>https://k.koudai.com/ZkmRxldV</a></p><h1 id='环境设置'><span>环境设置</span></h1><h1 id='environment-setting'><span>environment setting</span></h1><p><span>使用国内镜像安装包</span></p><p><span>use the domestic mirror installation package</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">options</span>(<span class="cm-string">"repos"</span><span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">CRAN</span><span class="cm-operator">=</span><span class="cm-string">"https://mirrors.tuna.tsinghua.edu.cn/CRAN/"</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">options</span>(<span class="cm-variable">BioC_mirror</span><span class="cm-operator">=</span><span class="cm-string">"http://mirrors.tuna.tsinghua.edu.cn/bioconductor/"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>加载包</span></p><p><span>load package</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">data.table</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">glmnet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">limma</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Sys.setenv</span>(<span class="cm-variable">LANGUAGE</span> <span class="cm-operator">=</span> <span class="cm-string">"en"</span>) <span class="cm-comment">#显示英文报错信息 display English error messages</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">options</span>(<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">FALSE</span>) <span class="cm-comment">#禁止chr转成factor prohibit the conversion of chr to factor</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><h1 id='输入文件的获得'><span>输入文件的获得</span></h1><h1 id='acquisition-of-input-files'><span>Acquisition of input files</span></h1><p><span>请到微云下载大文件</span><a href='https://share.weiyun.com/HHLSNqoC' target='_blank' class='url'>https://share.weiyun.com/HHLSNqoC</a></p><p><span>提取感兴趣的肿瘤及对照组织的表达数据。如果你已经准备好，就跳过这步，直接进入“输入文件”。</span></p><p><span>这里用TCGA的肿瘤，用GTEX的正常组织作为对照。从UCSC xena</span><a href='https://xenabrowser.net/datapages/' target='_blank' class='url'>https://xenabrowser.net/datapages/</a><span>下载经过TOIL流程统一处理的TCGA和GTEx的TPM值，free of computational batch effects。从中提取肝癌和肝脏数据。</span></p><ul><li><p><span>TCGA与GTEX合并的表达数据：</span><a href='https://xenabrowser.net/datapages/?dataset=TcgaTargetGtex_rsem_gene_tpm&amp;host=https%3A%2F%2Ftoil.xenahubs.net&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443' target='_blank' class='url'>https://xenabrowser.net/datapages/?dataset=TcgaTargetGtex_rsem_gene_tpm&host=https%3A%2F%2Ftoil.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443</a></p></li><li><p><span>样本注释信息：</span><a href='https://xenabrowser.net/datapages/?dataset=TcgaTargetGTEX_phenotype.txt&amp;host=https%3A%2F%2Ftoil.xenahubs.net&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443' target='_blank' class='url'>https://xenabrowser.net/datapages/?dataset=TcgaTargetGTEX_phenotype.txt&host=https%3A%2F%2Ftoil.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443</a></p></li></ul><p><span>我们在FigureYa55panCancer_violin有过类似的操作</span><a href='https://www.yuque.com/figureya/figureyaplus/figureya55p' target='_blank' class='url'>https://www.yuque.com/figureya/figureyaplus/figureya55p</a><span>。更多pancancer相关FigureYa看这里</span><a href='https://k.koudai.com/C8RkTgR3' target='_blank' class='url'>https://k.koudai.com/C8RkTgR3</a></p><p><span>Please download large files from Weiyun</span><a href='https://share.weiyun.com/HHLSNqoC' target='_blank' class='url'>https://share.weiyun.com/HHLSNqoC</a></p><p><span>Extract expression data for tumours and control tissues of interest. If you have already prepared these, skip this step and proceed directly to &quot;Input Files&quot;.</span></p><p><span>Here, we utilise TCGA tumours with GTEX normal tissues as controls. Download the TPM values for TCGA and GTEx, processed uniformly via the TOIL workflow and free of computational batch effects, from UCSC xena</span><a href='https://xenabrowser.net/datapages/' target='_blank' class='url'>https://xenabrowser.net/datapages/</a><span>. Extract data for hepatocellular carcinoma and liver tissue.</span></p><ul><li><p><span>Combined TCGA and GTEX expression data: </span><a href='https://xenabrowser.net/datapages/?dataset=TcgaTargetGtex_rsem_gene_tpm&amp;host=https%3A%2F%2Ftoil.xenahubs.net&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443' target='_blank' class='url'>https://xenabrowser.net/datapages/?dataset=TcgaTargetGtex_rsem_gene_tpm&host=https%3A%2F%2Ftoil.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443</a></p></li><li><p><span>Sample annotation information: </span><a href='https://xenabrowser.net/datapages/?dataset=TcgaTargetGTEX_phenotype.txt&amp;host=https%3A%2F%2Ftoil.xenahubs.net&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443' target='_blank' class='url'>https://xenabrowser.net/datapages/?dataset=TcgaTargetGTEX_phenotype.txt&host=https%3A%2F%2Ftoil.xenahubs.net&removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443</a></p></li></ul><p><span>我们在FigureYa55panCancer_violin有过类似的操作</span><a href='https://www.yuque.com/figureya/figureyaplus/figureya55p' target='_blank' class='url'>https://www.yuque.com/figureya/figureyaplus/figureya55p</a><span>。更多pancancer相关FigureYa看这里</span><a href='https://k.koudai.com/C8RkTgR3' target='_blank' class='url'>https://k.koudai.com/C8RkTgR3</a></p><p><span>We have performed similar operations on FigureYa55panCancer_violin</span><a href='https://www.yuque.com/figureya/figureyaplus/figureya55p' target='_blank' class='url'>https://www.yuque.com/figureya/figureyaplus/figureya55p</a><span>. For further pancancer related FigureYa, see here</span><a href='https://k.koudai.com/C8RkTgR3' target='_blank' class='url'>https://k.koudai.com/C8RkTgR3</a></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r eval=FALSE}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r eval=false}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 加载基因注释文件XENA网站</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load gene annotation file XENA website</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Ginfo</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-string">"overlapTable27.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenotype</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-string">"TcgaTargetGTEX_phenotype.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenotype</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">phenotype</span>[<span class="cm-variable">which</span>(<span class="cm-variable">phenotype</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_study`</span> <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">c</span>(<span class="cm-string">"TCGA"</span>,<span class="cm-string">"GTEX"</span>)),] <span class="cm-comment"># 仅筛选TCGA和GETX，移除TARGET filter out TCGA and GETX only, remove TARGET</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenotype</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">phenotype</span>[<span class="cm-variable">which</span>(<span class="cm-variable">phenotype</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_primary_site`</span> <span class="cm-operator">!=</span> <span class="cm-string">""</span>),] <span class="cm-comment"># 删除值为空的位点 remove site with empty value</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 以下数据（9个G）提取过程需要内存较大的电脑（纯R，不受操作系统限制）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 或者用cut命令提取（需Linux或MAC），可参考FigureYa56immune_inflitration</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># The extraction process for the following data (9 GB) requires a computer with substantial memory (pure R, not restricted by operating system)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Alternatively, use the cut command for extraction (requires Linux or MAC), refer to FigureYa56immune_inflitration</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">fread</span>(<span class="cm-string">"TcgaTargetGtex_rsem_gene_tpm"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tpm.df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">tpm</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ensembl</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sapply</span>(<span class="cm-variable">strsplit</span>(<span class="cm-variable">tpm</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">sample</span>,<span class="cm-string">"."</span>,<span class="cm-variable">fixed</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),<span class="cm-string">"["</span>,<span class="cm-number">1</span>) <span class="cm-comment"># 取出有效的Ensembl ID Retrieve valid Ensembl IDs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 过滤出感兴趣的数据集</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Filter out the datasets of interest</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sites</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">unique</span>(<span class="cm-variable">phenotype</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_primary_site`</span>) <span class="cm-comment"># 提出所有有效的位点 Identify all valid sites</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sites</span> <span class="cm-comment"># 查看位点 View sites</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tissue</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"Liver"</span> <span class="cm-comment"># 设置位点（必须为有效位点） Set site (must be a valid site)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">is.element</span>(<span class="cm-variable">tissue</span>, <span class="cm-variable">sites</span>)) { <span class="cm-comment"># 如不存在则报错 If it does not exist, report an error</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">stop</span>(<span class="cm-string">"incorrect tissue, should be one of the primary_site column in phenotype.txt file."</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenotype_tissue</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">phenotype</span>[<span class="cm-variable">which</span>(<span class="cm-variable">phenotype</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_primary_site`</span> <span class="cm-operator">==</span> <span class="cm-variable">tissue</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">length</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">phenotype_tissue</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_study`</span>)) <span class="cm-operator">==</span> <span class="cm-number">2</span>) { <span class="cm-comment"># 必须同时含有TCGA和GETX数据 Must contain both TCGA and GTEx data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tcga.barcode</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">phenotype_tissue</span>[<span class="cm-variable">which</span>(<span class="cm-variable">phenotype_tissue</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_study`</span> <span class="cm-operator">==</span> <span class="cm-string">"TCGA"</span>),]), <span class="cm-variable">colnames</span>(<span class="cm-variable">tpm.df</span>)) <span class="cm-comment"># 获取TCGA样本 get TCGA samples</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">gtex.barcode</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">phenotype_tissue</span>[<span class="cm-variable">which</span>(<span class="cm-variable">phenotype_tissue</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`_study`</span> <span class="cm-operator">==</span> <span class="cm-string">"GTEX"</span>),]), <span class="cm-variable">colnames</span>(<span class="cm-variable">tpm.df</span>)) <span class="cm-comment"># 获取GTEX样本 get GTEX samples</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tpm.df</span>[,<span class="cm-variable">c</span>(<span class="cm-variable">tcga.barcode</span>,<span class="cm-variable">gtex.barcode</span>)] &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">2</span><span class="cm-operator">^</span>(<span class="cm-variable">combined.tpm</span>) <span class="cm-operator">-</span> <span class="cm-number">0.001</span> <span class="cm-comment"># 官网数据为log2(x+0.001)转换的，这里转回来 The official website data has been converted to log2(x+0.001), and here it is converted back</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span>[<span class="cm-variable">combined.tpm</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">0</span> <span class="cm-comment"># 由于原数据是+0.001来的，所以这里所有&lt;0的数据均为最小值，拉为0 As the original data was +0.001, all values &lt;0 here represent the minimum value and are adjusted to 0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">log2</span>(<span class="cm-variable">combined.tpm</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>) <span class="cm-comment"># 重新对数化，保证0还是0 Re-logarithmisation ensures zero remains zero</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">rownames</span>(<span class="cm-variable">combined.tpm</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ensembl</span> <span class="cm-comment"># 添上行名 Add the row name</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">comgene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">combined.tpm</span>), <span class="cm-variable">rownames</span>(<span class="cm-variable">Ginfo</span>)) <span class="cm-comment"># 取出和注释文件一致的基因 Extract the genes corresponding to the annotated files</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 将Ensembl ID转为symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Convert Ensembl ID to symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">combined.tpm</span>[<span class="cm-variable">comgene</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">genename</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">Ginfo</span>[<span class="cm-variable">comgene</span>,<span class="cm-string">"genename"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">combined.tpm</span>[<span class="cm-operator">!</span><span class="cm-variable">duplicated</span>(<span class="cm-variable">combined.tpm</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">genename</span>),] <span class="cm-comment"># 去除重复基因 Remove duplicate genes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">rownames</span>(<span class="cm-variable">combined.tpm</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">combined.tpm</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">genename</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">combined.tpm</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">combined.tpm</span>[,<span class="cm-operator">-</span><span class="cm-variable">ncol</span>(<span class="cm-variable">combined.tpm</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">} <span class="cm-keyword">else</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">stop</span>(<span class="cm-string">"this tissue has only one of TCGA or GTEX data, please switch to another tissue."</span>) <span class="cm-comment"># 若缺少任何一个数据库，则报错 If any database is missing, an error will be reported</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 保存数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Save data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">write.table</span>(<span class="cm-variable">combined.tpm</span>,<span class="cm-variable">paste0</span>(<span class="cm-string">"tpms_"</span>,<span class="cm-variable">tissue</span>,<span class="cm-string">"_TCGAGTEX.txt"</span>),<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">col.names</span> <span class="cm-operator">=</span> <span class="cm-atom">NA</span>,<span class="cm-builtin">quote</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1771px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1771px;"></div></div></div></pre><h1 id='输入文件'><span>输入文件</span></h1><h1 id='input-files'><span>Input Files</span></h1><ul><li><p><span>训练集：</span></p><ul><li><p><span>tpms_Liver_TCGAGTEX.txt，TCGA（肝癌）和GTEX（正常组织）表达矩阵。文件太大，在微云上</span><a href='https://share.weiyun.com/HHLSNqoC' target='_blank' class='url'>https://share.weiyun.com/HHLSNqoC</a></p></li><li><p><span>lihc_sinfo.txt，TCGA肝癌临床信息</span></p></li></ul></li><li><p><span>测试集（GEO数据的下载及数据预处理可参考FigureYa203ComBat）</span></p><ul><li><p><span>gse101685.expr.txt，表达矩阵</span></p></li><li><p><span>gse101685.sinfo.txt，样本信息</span></p></li></ul></li></ul><p><span>加载数据，构建训练集和测试集，并定义早期肝癌与正常组织。</span></p><ul><li><p><span>Training set:</span></p><ul><li><p><span>tpms_Liver_TCGAGTEX.txt, TCGA (liver cancer) and GTEX (normal tissue) expression matrices. The file is too large and is available on Weiyun</span><a href='https://share.weiyun.com/HHLSNqoC' target='_blank' class='url'>https://share.weiyun.com/HHLSNqoC</a></p></li><li><p><span>lihc_sinfo.txt, TCGA liver cancer clinical information</span></p></li></ul></li><li><p><span>Test set (GEO data download and preprocessing can be referenced to FigureYa203ComBat)</span></p><ul><li><p><span>gse101685.expr.txt, expression matrix</span></p></li><li><p><span>gse101685.sinfo.txt, sample information</span></p></li></ul></li></ul><p><span>Load data, construct training and test sets, and define early-stage hepatocellular carcinoma versus normal tissue.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 训练集</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Training set</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 加载TCGA_GTEX肝癌表达谱数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load TCGA_GTEX liver cancer expression profile data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-string">"tpms_Liver_TCGAGTEX.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.index</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">grep</span>(<span class="cm-string">"TCGA"</span>,<span class="cm-variable">colnames</span>(<span class="cm-variable">tcga.expr</span>)) <span class="cm-comment"># 找到TCGA肝癌样本的索引 Find the index of TCGA liver cancer samples.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.barcode</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">tcga.expr</span>)[<span class="cm-variable">tcga.index</span>] <span class="cm-comment"># 取出样本名 Retrieve sample name</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.barcode</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">paste0</span>(<span class="cm-string">"LIHC"</span>,<span class="cm-variable">substr</span>(<span class="cm-variable">tcga.barcode</span>,<span class="cm-number">8</span>,<span class="cm-number">15</span>),<span class="cm-string">"A"</span>) <span class="cm-comment"># 修改样本名以匹配注释文件 Modify the sample name to match the annotation file</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">tcga.expr</span>)[<span class="cm-variable">tcga.index</span>] <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tcga.barcode</span> <span class="cm-comment"># 替换样本名 Replace sample name</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 加载TCGA肝癌临床信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Load TCGA liver cancer clinical information</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.sinfo</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-string">"lihc_sinfo.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.tumsam</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">tcga.sinfo</span>[<span class="cm-variable">which</span>(<span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">sampleType</span> <span class="cm-operator">==</span> <span class="cm-string">"Tumor"</span> <span class="cm-operator">&amp;</span> <span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">AJCC_PATHOLOGIC_TUMOR_STAGE</span> <span class="cm-operator">==</span> <span class="cm-string">"Stage I"</span>),]), <span class="cm-variable">tcga.barcode</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.norsam</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">tcga.sinfo</span>[<span class="cm-variable">which</span>(<span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">sampleType</span> <span class="cm-operator">==</span> <span class="cm-string">"Normal"</span>),]),<span class="cm-variable">tcga.barcode</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gtex.norsam</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">tcga.expr</span>)[<span class="cm-variable">grep</span>(<span class="cm-string">"GTEX"</span>,<span class="cm-variable">colnames</span>(<span class="cm-variable">tcga.expr</span>))] <span class="cm-comment"># 找到GTEX正常样本 Find the normal sample of GTEX</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 构建TCGAGTEX最终表达谱以及样本信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Construct the final expression profile and sample information for TCGAGTEX</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tcga.expr</span>[,<span class="cm-variable">c</span>(<span class="cm-variable">tcga.tumsam</span>,<span class="cm-variable">tcga.norsam</span>,<span class="cm-variable">gtex.norsam</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tcga.expr</span>[<span class="cm-variable">rowSums</span>(<span class="cm-variable">tcga.expr</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#rownames(tcga.expr) &lt;- gsub("-","_",rownames(tcga.expr),fixed = T)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tcga.sinfo</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">samID</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">tcga.tumsam</span>,<span class="cm-variable">tcga.norsam</span>,<span class="cm-variable">gtex.norsam</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">tissue</span> <span class="cm-operator">=</span> <span class="cm-variable">rep</span>(<span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>,<span class="cm-string">"Normal"</span>),<span class="cm-variable">c</span>(<span class="cm-variable">length</span>(<span class="cm-variable">tcga.tumsam</span>), <span class="cm-variable">length</span>(<span class="cm-variable">tcga.norsam</span>) <span class="cm-operator">+</span> <span class="cm-variable">length</span>(<span class="cm-variable">gtex.norsam</span>))),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">tcga.tumsam</span>,<span class="cm-variable">tcga.norsam</span>,<span class="cm-variable">gtex.norsam</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## 测试集</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Test set</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.delim</span>(<span class="cm-string">"gse101685.expr.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.expr</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">6</span>,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>] <span class="cm-comment"># 注意到行名里存在多种匹配，取///符号前的基因名（可以在EXCEL里检查一下，但不要用EXCEL进行任何操作，千万不要保存，否则可能出现月份） Note that there are multiple matches in the row names; take the gene name before the /// symbol (you can check this in EXCEL, but do not perform any operations within EXCEL, never save the file, or else you may encounter issues with date formats, such as the date being displayed as a month.)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.expr</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Gene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sapply</span>(<span class="cm-variable">strsplit</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">gse101685.expr</span>),<span class="cm-string">"</span> <span class="cm-string">/// "</span>,<span class="cm-variable">fixed</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),<span class="cm-string">"["</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">apply</span>(<span class="cm-variable">gse101685.expr</span>[,<span class="cm-variable">setdiff</span>(<span class="cm-variable">colnames</span>(<span class="cm-variable">gse101685.expr</span>), <span class="cm-string">"Gene"</span>)], <span class="cm-number">2</span>, <span class="cm-keyword">function</span>(<span class="cm-variable">x</span>) <span class="cm-variable">tapply</span>(<span class="cm-variable">x</span>, <span class="cm-variable">INDEX</span><span class="cm-operator">=</span><span class="cm-variable">factor</span>(<span class="cm-variable">gse101685.expr</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Gene</span>), <span class="cm-variable">FUN</span><span class="cm-operator">=</span><span class="cm-variable">median</span>, <span class="cm-variable">na.rm</span><span class="cm-operator">=</span><span class="cm-variable">TRUE</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">round</span>(<span class="cm-variable">gse101685.expr</span>,<span class="cm-number">2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">write.csv</span>(<span class="cm-variable">gse101685.expr</span>, <span class="cm-string">"easy_input_GSE101685.csv"</span>, <span class="cm-builtin">quote</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#rownames(gse101685.expr) &lt;- gsub("-","_",rownames(gse101685.expr),fixed = T)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse101685.sinfo</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.delim</span>(<span class="cm-string">"gse101685.sinfo.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">check.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse.tumsam</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">gse101685.sinfo</span>[<span class="cm-variable">which</span>(<span class="cm-variable">gse101685.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`1:TISSUE`</span> <span class="cm-operator">==</span> <span class="cm-string">"Hepatocellular carcinoma"</span> <span class="cm-operator">&amp;</span> <span class="cm-variable">gse101685.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`1:STAGE`</span> <span class="cm-operator">==</span> <span class="cm-string">"T1"</span>),]),<span class="cm-variable">colnames</span>(<span class="cm-variable">gse101685.expr</span>)) <span class="cm-comment"># 取出肝癌且早期的样本 Retrieve samples of early-stage liver cancer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse.norsam</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">gse101685.sinfo</span>[<span class="cm-variable">which</span>(<span class="cm-variable">gse101685.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable-3">`1:TISSUE`</span> <span class="cm-operator">==</span> <span class="cm-string">"Normal liver"</span>),]),<span class="cm-variable">colnames</span>(<span class="cm-variable">gse101685.expr</span>)) <span class="cm-comment"># 取出正常样本 Retrieve the normal sample</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 构建GSE最终表达谱以及样本信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Construct the final expression profile and sample information for GSE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse.expr</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">gse101685.expr</span>[,<span class="cm-variable">c</span>(<span class="cm-variable">gse.tumsam</span>,<span class="cm-variable">gse.norsam</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gse.sinfo</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">samID</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">gse.tumsam</span>,<span class="cm-variable">gse.norsam</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">tissue</span> <span class="cm-operator">=</span> <span class="cm-variable">rep</span>(<span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>,<span class="cm-string">"Normal"</span>),<span class="cm-variable">c</span>(<span class="cm-variable">length</span>(<span class="cm-variable">gse.tumsam</span>),<span class="cm-variable">length</span>(<span class="cm-variable">gse.norsam</span>))),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">gse.tumsam</span>,<span class="cm-variable">gse.norsam</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1863px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1863px;"></div></div></div></pre><h1 id='构建弹性网络预测模型查看效果'><span>构建弹性网络预测模型，查看效果</span></h1><h1 id='construct-an-elastic-net-prediction-model-and-check-the-effect'><span>Construct an elastic net prediction model and check the effect</span></h1><p><span>根据弹性网络筛选变量构建分类模型。</span></p><p><span>在训练集构建弹性网络预测模型，分别查看模型在训练集和测试集的效果。</span></p><p><span>Build a classification model by selecting variables based on the elastic net.</span></p><p><span>Build an elastic net predictive model on the training set and examine the effectiveness on both the training set and the test set.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 选取共同基因</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Select common genes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">comgene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">intersect</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">tcga.expr</span>),<span class="cm-variable">rownames</span>(<span class="cm-variable">gse.expr</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 先挑选一部分差异表达基因来构建模型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># First, select a subset of differentially expressed genes to construct the model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pd</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">Samples</span> <span class="cm-operator">=</span> <span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">samID</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Group</span> <span class="cm-operator">=</span> <span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">stringsAsFactors</span> <span class="cm-operator">=</span> <span class="cm-variable">FALSE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">design</span> <span class="cm-operator cm-arrow">&lt;-</span><span class="cm-variable">model.matrix</span>(<span class="cm-operator">~</span> <span class="cm-operator">-</span><span class="cm-number">1</span> <span class="cm-operator">+</span> <span class="cm-variable">factor</span>(<span class="cm-variable">pd</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Group</span>, <span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>,<span class="cm-string">"Normal"</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>,<span class="cm-string">"Normal"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gset</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tcga.expr</span>[<span class="cm-variable">comgene</span>,<span class="cm-variable">pd</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Samples</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">limma</span><span class="cm-operator">::</span><span class="cm-variable">lmFit</span>(<span class="cm-variable">gset</span>, <span class="cm-variable">design</span> <span class="cm-operator">=</span> <span class="cm-variable">design</span>)<span class="cm-semi">;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">contrastsMatrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">limma</span><span class="cm-operator">::</span><span class="cm-variable">makeContrasts</span>(<span class="cm-variable">Tumor</span> <span class="cm-operator">-</span> <span class="cm-variable">Normal</span>, <span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>, <span class="cm-string">"Normal"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">limma</span><span class="cm-operator">::</span><span class="cm-variable">contrasts.fit</span>(<span class="cm-variable">fit</span>, <span class="cm-variable">contrasts</span> <span class="cm-operator">=</span> <span class="cm-variable">contrastsMatrix</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">limma</span><span class="cm-operator">::</span><span class="cm-variable">eBayes</span>(<span class="cm-variable">fit2</span>, <span class="cm-number">0.01</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resData</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">limma</span><span class="cm-operator">::</span><span class="cm-variable">topTable</span>(<span class="cm-variable">fit2</span>, <span class="cm-variable">adjust</span> <span class="cm-operator">=</span> <span class="cm-string">"fdr"</span>, <span class="cm-variable">sort.by</span> <span class="cm-operator">=</span> <span class="cm-string">"B"</span>, <span class="cm-variable">number</span> <span class="cm-operator">=</span> <span class="cm-number">100000</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resData</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">subset</span>(<span class="cm-variable">resData</span>, <span class="cm-variable">select</span><span class="cm-operator">=</span><span class="cm-variable">c</span>(<span class="cm-string">"logFC"</span>,<span class="cm-string">"t"</span>,<span class="cm-string">"B"</span>,<span class="cm-string">"P.Value"</span>,<span class="cm-string">"adj.P.Val"</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">id</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">resData</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">resData</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"log2fc"</span>,<span class="cm-string">"t"</span>,<span class="cm-string">"B"</span>,<span class="cm-string">"pvalue"</span>,<span class="cm-string">"padj"</span>,<span class="cm-string">"id"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">fc</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">2</span><span class="cm-operator">^</span><span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">log2fc</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resData</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">resData</span>[<span class="cm-variable">order</span>(<span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">padj</span>),<span class="cm-variable">c</span>(<span class="cm-string">"id"</span>,<span class="cm-string">"fc"</span>,<span class="cm-string">"log2fc"</span>,<span class="cm-string">"pvalue"</span>,<span class="cm-string">"padj"</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">write.table</span>(<span class="cm-variable">resData</span>,<span class="cm-string">"limma results between early liver cancer and normal tissues.txt"</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">col.names</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-builtin">quote</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 训练弹性网络</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Train elastic networks</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">degs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">resData</span>[<span class="cm-variable">which</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">log2fc</span>) <span class="cm-operator">&gt;</span> <span class="cm-variable">log2</span>(<span class="cm-number">1.5</span>) <span class="cm-operator">&amp;</span> <span class="cm-variable">resData</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">padj</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0.05</span>),] <span class="cm-comment"># 取出差异表达基因 Extract differentially expressed genes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">scale</span>(<span class="cm-variable">t</span>(<span class="cm-variable">tcga.expr</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">degs</span>),<span class="cm-variable">rownames</span>(<span class="cm-variable">tcga.sinfo</span>)])) <span class="cm-comment"># 数据标准化 Data standardisation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.factor</span>(<span class="cm-variable">ifelse</span>(<span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span> <span class="cm-operator">==</span> <span class="cm-string">"Tumor"</span>,<span class="cm-number">1</span>,<span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">set.seed</span>(<span class="cm-number">20201104</span>) <span class="cm-comment"># 设置种子使得结果可重复 Set the seed to ensure reproducible results</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">cvfit</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">cv.glmnet</span>(<span class="cm-variable">x</span>, <span class="cm-variable">y</span>, </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">nfolds</span> <span class="cm-operator">=</span> <span class="cm-variable">nrow</span>(<span class="cm-variable">x</span>), <span class="cm-comment"># 余一交叉验证 Leave-one-out cross-validation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">family</span> <span class="cm-operator">=</span> <span class="cm-string">"binomial"</span>, <span class="cm-comment"># 二分类模型 Binary classification model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">grouped</span> <span class="cm-operator">=</span> <span class="cm-variable">FALSE</span>, <span class="cm-comment"># 在余一交叉验证的时候设置为FALSE Set it to FALSE during leave-one-out cross-validation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.9</span>, <span class="cm-comment"># 原文参数（alpha=0为岭回归；=1为lasso；=0~1为弹性网络） Original text parameters (alpha=0 for ridge regression; alpha=1 for lasso; alpha between 0 and 1 for elastic net)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">type.measure</span> <span class="cm-operator">=</span> <span class="cm-string">"deviance"</span>) <span class="cm-comment"># 原文参数 Original text parameters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 取出系数不为0的变量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Extract variables with non-zero coefficients</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">myCoefs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">coef</span>(<span class="cm-variable">cvfit</span>, <span class="cm-variable">s</span><span class="cm-operator">=</span><span class="cm-string">"lambda.min"</span>)<span class="cm-semi">;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lasso_fea</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">coef</span>(<span class="cm-variable">cvfit</span>, <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-string">'lambda.min'</span>))[<span class="cm-variable">coef</span>(<span class="cm-variable">cvfit</span>, <span class="cm-variable">s</span> <span class="cm-operator">=</span> <span class="cm-string">'lambda.min'</span>)[,<span class="cm-number">1</span>]<span class="cm-operator">!=</span> <span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">is.element</span>(<span class="cm-string">"(Intercept)"</span>, <span class="cm-variable">lasso_fea</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">lasso_fea</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lasso_fea</span>[<span class="cm-operator">-</span><span class="cm-number">1</span>] <span class="cm-comment"># 去掉截距项 Remove the intercept term</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看模型在训练集的效果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Examine the performance of the model on the training set</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred_train</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">prob</span> <span class="cm-operator">=</span> <span class="cm-variable">round</span>(<span class="cm-variable">predict</span>(<span class="cm-variable">cvfit</span>, <span class="cm-variable">newx</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>,<span class="cm-variable">type</span><span class="cm-operator">=</span><span class="cm-string">"response"</span>),<span class="cm-number">4</span>)[,<span class="cm-number">1</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">tissue</span> <span class="cm-operator">=</span> <span class="cm-variable">tcga.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看模型在测试集的效果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Examine the performance of the model on the test set</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.matrix</span>(<span class="cm-variable">as.data.frame</span>(<span class="cm-variable">scale</span>(<span class="cm-variable">t</span>(<span class="cm-variable">gse.expr</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">degs</span>),<span class="cm-variable">gse.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">samID</span>]))))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred_test</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">prob</span> <span class="cm-operator">=</span> <span class="cm-variable">round</span>(<span class="cm-variable">predict</span>(<span class="cm-variable">cvfit</span>, <span class="cm-variable">newx</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>,<span class="cm-variable">type</span><span class="cm-operator">=</span><span class="cm-string">"response"</span>),<span class="cm-number">4</span>)[,<span class="cm-number">1</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">tissue</span> <span class="cm-operator">=</span> <span class="cm-variable">gse.sinfo</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1748px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1748px;"></div></div></div></pre><h1 id='开始画图'><span>开始画图</span></h1><h1 id='start-drawing'><span>Start drawing</span></h1><p><span>生成筛选和系数图，以及分类效果图。</span></p><p><span>Generate screening and coefficient plots, along with classification performance diagrams.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Figure 2A</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pdf</span>(<span class="cm-string">"Figure2A.pdf"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">4.5</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">par</span>(<span class="cm-variable">bty</span><span class="cm-operator">=</span><span class="cm-string">"o"</span>, <span class="cm-variable">mgp</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">2</span>,<span class="cm-number">0.5</span>,<span class="cm-number">0</span>), <span class="cm-variable">mar</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">3.1</span>,<span class="cm-number">3.1</span>,<span class="cm-number">2.1</span>,<span class="cm-number">2.1</span>),<span class="cm-variable">tcl</span><span class="cm-operator">=-</span><span class="cm-number">.25</span>,<span class="cm-variable">las</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">cvfit</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dev.off</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><img src="Figure2A.pdf"></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Figure 2B</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pdf</span>(<span class="cm-string">"Figure2B.pdf"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">4.5</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">par</span>(<span class="cm-variable">bty</span><span class="cm-operator">=</span><span class="cm-string">"o"</span>, <span class="cm-variable">mgp</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">2</span>,<span class="cm-number">0.5</span>,<span class="cm-number">0</span>), <span class="cm-variable">mar</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">3.1</span>,<span class="cm-number">3.1</span>,<span class="cm-number">2.1</span>,<span class="cm-number">2.1</span>),<span class="cm-variable">tcl</span><span class="cm-operator">=-</span><span class="cm-number">.25</span>,<span class="cm-variable">las</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">cvfit</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">glmnet.fit</span>, <span class="cm-string">"lambda"</span>, <span class="cm-variable">label</span><span class="cm-operator">=</span><span class="cm-variable">FALSE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dev.off</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><p><img src="Figure2B.pdf"></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Figure 2C</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">coeff</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">myCoefs</span>@<span class="cm-variable">x</span>[<span class="cm-operator">-</span><span class="cm-number">1</span>]<span class="cm-semi">;</span> <span class="cm-variable">names</span>(<span class="cm-variable">coeff</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lasso_fea</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">coeff</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sort</span>(<span class="cm-variable">coeff</span>,<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">coeff.dt</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">gene</span> <span class="cm-operator">=</span> <span class="cm-variable">rep</span>(<span class="cm-variable">names</span>(<span class="cm-variable">coeff</span>),<span class="cm-number">2</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">coeff</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-variable">as.numeric</span>(<span class="cm-variable">coeff</span>),<span class="cm-operator">-</span><span class="cm-variable">as.numeric</span>(<span class="cm-variable">coeff</span>)),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">tissue</span> <span class="cm-operator">=</span> <span class="cm-variable">rep</span>(<span class="cm-variable">c</span>(<span class="cm-string">"Tumor"</span>,<span class="cm-string">"Normal"</span>),<span class="cm-variable">c</span>(<span class="cm-variable">length</span>(<span class="cm-variable">coeff</span>),<span class="cm-variable">length</span>(<span class="cm-variable">coeff</span>))))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">coeff.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">gene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">factor</span>(<span class="cm-variable">coeff.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">gene</span>, <span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">names</span>(<span class="cm-variable">coeff</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">data</span><span class="cm-operator">=</span><span class="cm-variable">coeff.dt</span>, <span class="cm-variable">aes</span>(<span class="cm-variable">x</span><span class="cm-operator">=</span><span class="cm-variable">gene</span>, <span class="cm-variable">y</span><span class="cm-operator">=</span><span class="cm-variable">coeff</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">tissue</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_bar</span>(<span class="cm-variable">stat</span><span class="cm-operator">=</span><span class="cm-string">"identity"</span>) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_fill_manual</span>(<span class="cm-variable">values</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"#E4191B"</span>,<span class="cm-string">"#357EB8"</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">coord_flip</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">facet_grid</span>( <span class="cm-operator">~</span> <span class="cm-variable">tissue</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme_bw</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ylab</span>(<span class="cm-string">"Coefficient"</span>) <span class="cm-operator">+</span> <span class="cm-variable">xlab</span>(<span class="cm-string">""</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme</span>(<span class="cm-variable">legend.position</span> <span class="cm-operator">=</span> <span class="cm-string">"none"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">axis.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">12</span>,<span class="cm-variable">color</span> <span class="cm-operator">=</span> <span class="cm-string">"black"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">axis.text</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">color</span> <span class="cm-operator">=</span> <span class="cm-string">"black"</span>))</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><p><img src="/Users/jing/Downloads/FigureYa/218/p.png" alt="p"></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{R}" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggsave</span>(<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-string">"Figure2C.pdf"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">8</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Figure 2E</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tmp1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pred_test</span>[<span class="cm-variable">which</span>(<span class="cm-variable">pred_test</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span> <span class="cm-operator">==</span> <span class="cm-string">"Tumor"</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tmp2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pred_test</span>[<span class="cm-variable">which</span>(<span class="cm-variable">pred_test</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tissue</span> <span class="cm-operator">==</span> <span class="cm-string">"Normal"</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tmp1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tmp1</span>[<span class="cm-variable">order</span>(<span class="cm-variable">tmp1</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">prob</span>,<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),] <span class="cm-comment"># 肿瘤概率降序 Tumor probability in descending order</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tmp2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tmp2</span>[<span class="cm-variable">order</span>(<span class="cm-variable">tmp2</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">prob</span>,<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>),] <span class="cm-comment"># 正常概率升序 Normal probability in ascending order</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred.dt</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rbind.data.frame</span>(<span class="cm-variable">tmp1</span>,<span class="cm-variable">tmp2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Pred.Tumor</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pred.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">prob</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Pred.Normal</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-number">1</span><span class="cm-operator">-</span><span class="cm-variable">pred.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">prob</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pred.dt</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">sample</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">length</span>(<span class="cm-variable">gse.tumsam</span>), <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">length</span>(<span class="cm-variable">gse.norsam</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">long</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">melt</span>(<span class="cm-variable">setDT</span>(<span class="cm-variable">pred.dt</span>[,<span class="cm-number">2</span><span class="cm-operator">:</span><span class="cm-number">5</span>]), <span class="cm-variable">id.vars</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"tissue"</span>,<span class="cm-string">"sample"</span>), <span class="cm-variable">variable.name</span> <span class="cm-operator">=</span> <span class="cm-string">"pred"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">data</span><span class="cm-operator">=</span><span class="cm-variable">long</span>, <span class="cm-variable">aes</span>(<span class="cm-variable">x</span><span class="cm-operator">=</span><span class="cm-variable">sample</span>, <span class="cm-variable">y</span><span class="cm-operator">=</span><span class="cm-variable">value</span>,<span class="cm-variable">color</span> <span class="cm-operator">=</span> <span class="cm-variable">pred</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">stat</span><span class="cm-operator">=</span><span class="cm-string">"identity"</span>) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_color_manual</span>(<span class="cm-variable">values</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"#E4191B"</span>,<span class="cm-string">"#357EB8"</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">facet_grid</span>( <span class="cm-operator">~</span> <span class="cm-variable">tissue</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme_bw</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ylab</span>(<span class="cm-string">"Probability"</span>) <span class="cm-operator">+</span> <span class="cm-variable">xlab</span>(<span class="cm-string">"Sample"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme</span>(<span class="cm-variable">legend.position</span> <span class="cm-operator">=</span> <span class="cm-string">"bottom"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">legend.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_blank</span>(),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">axis.text</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">colour</span> <span class="cm-operator">=</span> <span class="cm-string">"black"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">axis.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">12</span>,<span class="cm-variable">color</span> <span class="cm-operator">=</span> <span class="cm-string">"black"</span>))</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 644px;"></div><div class="CodeMirror-gutters" style="display: none; height: 644px;"></div></div></div></pre><p><img src="/Users/jing/Downloads/FigureYa/218/p2.png" alt="p2"></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggsave</span>(<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-string">"Figure2E.pdf"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><h1 id='session-info'><span>Session Info</span></h1><h1 id='会话信息'><span>会话信息</span></h1><pre class="md-fences md-end-block ty-contain-cm" spellcheck="false" lang="{r}"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="{r}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sessionInfo</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></div></div>
</body>
</html>